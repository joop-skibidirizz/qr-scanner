<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Hitster Test</title>
  <script src="https://unpkg.com/html5-qrcode"></script>
</head>

<body style="text-align:center; font-family:sans-serif;">
  <h2>Hitster QR</h2>
  <button id="start">START</button>
  <div id="reader" style="width:300px; margin:auto; display:none;"></div>
  <p id="status">wachten</p>

  <audio id="audio"></audio>

<script>
const startBtn = document.getElementById("start");
const reader = document.getElementById("reader");
const status = document.getElementById("status");
const audio = document.getElementById("audio");

const SILENT =
 "data:audio/mp3;base64,//uQZAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAACAAACcQCAAAAAAAAA";

let qr;

startBtn.onclick = async () => {
  // ðŸ”“ AUDIO UNLOCK â€“ DIT MOET ALS EERSTE
  audio.src = SILENT;
  audio.muted = true;
  await audio.play();
  audio.pause();
  audio.muted = false;

  // UI
  startBtn.style.display = "none";
  reader.style.display = "block";
  status.innerText = "scanâ€¦";

  // CAMERA PAS NA AUDIO
  qr = new Html5Qrcode("reader");
  const cams = await Html5Qrcode.getCameras();
  await qr.start(cams[0].id, { fps: 10, qrbox: 250 }, onScan);
};

function onScan(url) {
  qr.pause();
  audio.src = url;
  audio.play();
  status.innerText = "ðŸŽ¶ speelt 30s";

  setTimeout(() => {
    audio.pause();
    status.innerText = "stop â€“ raad!";
    qr.resume();
  }, 30000);
}
</script>
</body>
</html>
